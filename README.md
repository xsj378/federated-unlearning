# From federated learning to unlearning（联邦忘却学习）
![](https://img.shields.io/badge/python-3.6-blue) ![](https://img.shields.io/badge/pytorch-1.8.1-green) ![](https://img.shields.io/badge/cuda-10.1-blue)

通过联邦忘却学习撤销用户数据对模型更新的方式解决联邦学习中存在的隐私泄露问题。联邦忘却学习的一般架构图：

<img src="/doc/structure.png" width="50%" height="50%">

具体流程；
+ 联邦学习。中心服务器协同用户进行联邦学习，训练得到最优模型参数。
+ 数据更新撤销。用户可以在任意时刻向中心服务器发送撤销数据请求。中心服务器根据用户的请求使用忘却学习算法重新训练得到的模型参数。
+ 用户将数据从联邦学习系统中删除，防止数据被重新训练。
+ 重新开始联邦学习任务，恢复全局模型的准确率。

## 忘却请求
用户在不同场景下提出的联邦忘却学习请求有所不同，主要体现在联邦忘却学习对全局模型的忘却粒度。
+ 样本忘却。样本忘却是从联邦学习模型中撤销特定数据样本对模型的训练更新，是细粒度的忘却学习请求，也是联邦忘却学习中常见的请求之一。
+ 类别忘却。类别忘却用于分类任务中撤销单个或多个类别的数据对全局模型的训练更新。
+ 任务忘却。在多任务训练模式下，模型学习多个任务时可以因任务之间的相关性获得性能上的收益。任务忘却是粗粒度的忘却学习请求，用于撤销某个任务所有数据对模型的训练更新，但会因大量的数据撤销而产生灾难性的忘却。

## 联邦忘却学习算法
### 1. 面向全局模型的联邦忘却学习算法
面向全局模型的联邦忘却学习算法通过直接修改全局模型参数来实现对目标数据的忘却。
#### 1.1 重新训练
重新训练能够完全撤销特定用户对模型的训练更新，是将全局模型训练后的参数初始化为随机值，并在剩余数据集上重新训练。

<img src="/doc/structure.png" width="50%" height="50%">
