# D:\Anaconda\envs\test1\python.exe C:/Users/xsj/Desktop/unlearning/main.py
# ----------1.处理数据阶段----------
# ----------2.分发数据阶段----------
# ----------2.联邦学习阶段----------
# ----------epoch=1----------
# ----------1.1 创建数量为6的客户端----------
# ----------创建成功----------
# ----------1.2 分配模型----------
# ----------分配成功----------
# ----------1.3 开始训练----------
# ----------第1个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.790187
# There is epoch:100 epoch_ind:99 in loss:1.744513
# There is epoch:100 epoch_ind:99 in loss:1.600271
# ----------第2个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.885634
# There is epoch:100 epoch_ind:99 in loss:1.739440
# There is epoch:100 epoch_ind:99 in loss:1.651495
# ----------第3个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.891577
# There is epoch:100 epoch_ind:99 in loss:1.752244
# There is epoch:100 epoch_ind:99 in loss:1.773896
# ----------第4个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.895116
# There is epoch:100 epoch_ind:99 in loss:1.754031
# There is epoch:100 epoch_ind:99 in loss:1.726425
# ----------第5个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:2.285726
# There is epoch:100 epoch_ind:99 in loss:2.282240
# There is epoch:100 epoch_ind:99 in loss:2.161723
# ----------第6个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:2.280013
# There is epoch:200 epoch_ind:199 in loss:2.289136
# There is epoch:100 epoch_ind:99 in loss:2.311479
# There is epoch:200 epoch_ind:199 in loss:2.311563
# There is epoch:100 epoch_ind:99 in loss:2.315936
# There is epoch:200 epoch_ind:199 in loss:2.312384
#
# Test set : Average loss : 1.7191, Accuracy: 7524/10000 ( 75.24%)
#
# ----------epoch=2----------
# ----------1.1 创建数量为6的客户端----------
# ----------创建成功----------
# ----------1.2 分配模型----------
# ----------分配成功----------
# ----------1.3 开始训练----------
# ----------第1个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.663266
# There is epoch:100 epoch_ind:99 in loss:1.708161
# There is epoch:100 epoch_ind:99 in loss:1.590790
# ----------第2个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.692669
# There is epoch:100 epoch_ind:99 in loss:1.736684
# There is epoch:100 epoch_ind:99 in loss:1.656515
# ----------第3个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.743893
# There is epoch:100 epoch_ind:99 in loss:1.727998
# There is epoch:100 epoch_ind:99 in loss:1.733159
# ----------第4个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.814826
# There is epoch:100 epoch_ind:99 in loss:1.734137
# There is epoch:100 epoch_ind:99 in loss:1.711529
# ----------第5个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:2.249756
# There is epoch:100 epoch_ind:99 in loss:2.261527
# There is epoch:100 epoch_ind:99 in loss:2.148179
# ----------第6个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:2.365531
# There is epoch:200 epoch_ind:199 in loss:2.306981
# There is epoch:100 epoch_ind:99 in loss:2.308396
# There is epoch:200 epoch_ind:199 in loss:2.309581
# There is epoch:100 epoch_ind:99 in loss:2.306707
# There is epoch:200 epoch_ind:199 in loss:2.303127
#
# Test set : Average loss : 1.6895, Accuracy: 7719/10000 ( 77.19%)
#
# ----------epoch=3----------
# ----------1.1 创建数量为6的客户端----------
# ----------创建成功----------
# ----------1.2 分配模型----------
# ----------分配成功----------
# ----------1.3 开始训练----------
# ----------第1个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.495617
# There is epoch:100 epoch_ind:99 in loss:1.515275
# There is epoch:100 epoch_ind:99 in loss:1.500425
# ----------第2个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.549865
# There is epoch:100 epoch_ind:99 in loss:1.493071
# There is epoch:100 epoch_ind:99 in loss:1.499663
# ----------第3个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.545915
# There is epoch:100 epoch_ind:99 in loss:1.487536
# There is epoch:100 epoch_ind:99 in loss:1.490609
# ----------第4个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.617245
# There is epoch:100 epoch_ind:99 in loss:1.521611
# There is epoch:100 epoch_ind:99 in loss:1.516749
# ----------第5个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:2.188846
# There is epoch:100 epoch_ind:99 in loss:2.255672
# There is epoch:100 epoch_ind:99 in loss:2.134933
# ----------第6个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:2.416410
# There is epoch:200 epoch_ind:199 in loss:2.321724
# There is epoch:100 epoch_ind:99 in loss:2.309068
# There is epoch:200 epoch_ind:199 in loss:2.315037
# There is epoch:100 epoch_ind:99 in loss:2.301161
# There is epoch:200 epoch_ind:199 in loss:2.306583
#
# Test set : Average loss : 1.5086, Accuracy: 9601/10000 ( 96.01%)
#
# ----------epoch=4----------
# ----------1.1 创建数量为6的客户端----------
# ----------创建成功----------
# ----------1.2 分配模型----------
# ----------分配成功----------
# ----------1.3 开始训练----------
# ----------第1个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.483558
# There is epoch:100 epoch_ind:99 in loss:1.510763
# There is epoch:100 epoch_ind:99 in loss:1.478296
# ----------第2个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.497413
# There is epoch:100 epoch_ind:99 in loss:1.520970
# There is epoch:100 epoch_ind:99 in loss:1.476991
# ----------第3个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.516891
# There is epoch:100 epoch_ind:99 in loss:1.473064
# There is epoch:100 epoch_ind:99 in loss:1.481367
# ----------第4个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:1.606550
# There is epoch:100 epoch_ind:99 in loss:1.508924
# There is epoch:100 epoch_ind:99 in loss:1.510497
# ----------第5个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:2.202556
# There is epoch:100 epoch_ind:99 in loss:2.263730
# There is epoch:100 epoch_ind:99 in loss:2.139821
# ----------第6个客户端开启训练----------
# There is epoch:100 epoch_ind:99 in loss:2.326183
# There is epoch:200 epoch_ind:199 in loss:2.368338
# There is epoch:100 epoch_ind:99 in loss:2.316868
# There is epoch:200 epoch_ind:199 in loss:2.306609
# There is epoch:100 epoch_ind:99 in loss:2.299423
# There is epoch:200 epoch_ind:199 in loss:2.311440
#
# Test set : Average loss : 1.5020, Accuracy: 9655/10000 ( 96.55%)
#
#
# Test set : Average loss : 1.5020, Accuracy: 9655/10000 ( 96.55%)
#
# ----------3.模型保存----------
# 模型保存成功~路径为C:/Users/xsj/Desktop/unlearning/save/models/output-0.17.pt
# ----------5.忘却学习阶段----------
# Wref：
# Test set : Average loss : 1.4922, Accuracy: 9708/10000 ( 97.08%)
# 18000 60000
# 0 18000
# 0 60000
# --------------------target_client1--------------------
# 忘却训练：
# ---------------epoch1--------------
# Test set : Average loss : 2.2977, Accuracy: 2230/18000 ( 12.39%)
# Use gradient_up
# Test set : Average loss : 2.2977, Accuracy: 2232/18000 ( 12.40%)
# ---------------epoch2--------------
# Test set : Average loss : 2.2977, Accuracy: 2232/18000 ( 12.40%)
# Use gradient_up
# Test set : Average loss : 2.2977, Accuracy: 2232/18000 ( 12.40%)
# ---------------epoch3--------------
# Test set : Average loss : 2.2977, Accuracy: 2232/18000 ( 12.40%)
# Use gradient_up
# Test set : Average loss : 2.2977, Accuracy: 2231/18000 ( 12.39%)
# ---------------epoch4--------------
# Test set : Average loss : 2.2977, Accuracy: 2231/18000 ( 12.39%)
# Use gradient_up
# Test set : Average loss : 2.2977, Accuracy: 2229/18000 ( 12.38%)
# ---------------epoch5--------------
# Test set : Average loss : 2.2977, Accuracy: 2229/18000 ( 12.38%)
# Use gradient_up
# Test set : Average loss : 2.2977, Accuracy: 2229/18000 ( 12.38%)
# 提升训练：
# There is epoch:1 epoch_ind:0 in loss:2.248937
# There is epoch:1 epoch_ind:1 in loss:2.251831
# There is epoch:1 epoch_ind:2 in loss:2.246574
# There is epoch:1 epoch_ind:3 in loss:2.227032
# There is epoch:1 epoch_ind:4 in loss:2.236105
# Test set : Average loss : 2.1966, Accuracy: 4125/10000 ( 41.25%)
# Test set : Average loss : 2.2722, Accuracy: 9621/10000 ( 96.21%)
# Success
#
# Test set : Average loss : 2.2722, Accuracy: 9621/10000 ( 96.21%)
#
#
# Process finished with exit code 0
